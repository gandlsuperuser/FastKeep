# cursor-rules.md â€” FastKeep Project

## ðŸ§  Purpose

These rules guide Cursor when working on the **FastKeep Accounting SaaS** codebase (a QuickBooks-like system). They help maintain consistent quality, reduce re-work, and keep development structured.

---

# 1. General Workflow Rules

* Always read and update the **Scratchpad** before starting any implementation.
* Think through architecture decisions before writing code.
* Break large tasks into smaller subtasks.
* Mark progress with:

  * `[X]` â€” completed
  * `[ ]` â€” pending
* Update Scratchpad after finishing each task.
* After finishing a major feature, add a note to **Lessons** about what worked, mistakes to avoid, or improvements.

---

# 2. Project-Wide Standards

## 2.1 Code Style

* Use TypeScript everywhere.
* Use Next.js App Router.
* Always validate inputs with Zod.
* Use Prisma for data access.
* Use Shadcn UI for consistent components.

## 2.2 Architecture

* Follow modular folder structure:

  * `/app`
  * `/components`
  * `/lib`
  * `/db`
  * `/modules`
  * `/hooks`
  * `/actions`
* Group features into modules:

  * `/modules/auth`
  * `/modules/invoice`
  * `/modules/ledger`
  * `/modules/products`
  * `/modules/customers`
  * `/modules/vendors`
  * `/modules/banking`
  * `/modules/reports`
  * `/modules/subscription`
  * `/modules/settings`

## 2.3 UI/UX

* Use Shadcn components.
* Keep styling consistent and minimal.
* Maintain responsive layouts.
* Use cards, tables, charts, dialogs.

---

# 3. FastKeep Feature Requirements (QuickBooks-Like)

## 3.1 Authentication / Users

* Sign up / Sign in
* Magic link login
* Organization management
* User roles: admin, accountant, viewer

## 3.2 Products / Services Module

* Create products/services
* Track cost, price, inventory

## 3.3 Customer Management

* CRUD customers
* Credit terms
* Billing & shipping info

## 3.4 Vendor Management

* CRUD vendors
* Purchase terms

## 3.5 Invoicing System

* Create invoices
* Invoice numbering
* Draft â†’ Sent â†’ Paid flow
* Send invoice email (Resend)
* PDF invoice generation
* Partial payments
* Taxes & discounts

## 3.6 Estimates / Quotes

* Convert estimate â†’ invoice

## 3.7 Expenses

* Record expenses
* Attach receipts (UploadThing)
* Categorize expenses
* Vendor assignment

## 3.8 Chart of Accounts

* Parent/child accounts
* Auto-generated default accounts

## 3.9 General Ledger

* Double-entry bookkeeping
* Debit/credit locked rules
* Ledger transactions auto-created

## 3.10 Banking

* Import CSV bank statements
* Auto-transaction matching
* Reconciliation workflow

## 3.11 Reports

* Profit & Loss
* Balance Sheet
* Cash Flow
* General Ledger
* Sales by Product
* Tax Summary

## 3.12 Subscriptions (Stripe)

* Free plan
* Pro plan
* Billing portal
* Webhooks
* Subscription sync

## 3.13 Settings

* Business profile
* Tax settings
* Invoice templates
* Payment preferences

---

# 4. Cursor Task Behavior Rules

## 4.1 When Coding

* Think first, code second.
* Use TODO comments when needed.
* Update Scratchpad before and after work.

## 4.2 When Modifying Code

* Never break existing features.
* Refactor only when asked.
* Document changes in Scratchpad.

## 4.3 When Creating New Features

Consider:

* DB schema
* API routes
* Server Actions
* UI components
* Permissions
* Validation
* Background tasks

## 4.4 When Fixing Bugs

* Reproduce issue
* Identify root cause
* Patch
* Add lesson entry

---

# 5. Scratchpad (for FastKeep Project - QuickBooks-like Accounting SaaS)

Keep updated continuously.

## 1. Core Project Setup

* [X] Initialize Next.js 15 project with TypeScript (Note: Using Next.js 16 which is newer)
* [X] Set up project structure and folders:
  - `/app` (App Router)
  - `/components` (UI components)
  - `/lib` (utilities, helpers)
  - `/db` (Prisma client, migrations)
  - `/modules` (feature modules)
  - `/hooks` (custom React hooks)
  - `/actions` (Server Actions)
  - `/store` (Zustand stores)
* [X] Configure ESLint and Prettier
* [X] Install and configure dependencies:
  - Shadcn UI (component library)
  - Lucide React (icons)
  - Zod (schema validation)
  - Zustand (state management)
  - Recharts (charts and graphs)
  - Resend (email service)
  - Uploadthing (file uploads)
  - Prisma (ORM)
  - next-auth@beta (authentication)
  - Stripe (payments/subscriptions)
* [X] Configure Tailwind CSS
* [X] Set up Shadcn UI components (basic setup with Button component and utils)
* [X] Create base layout & navigation
* [X] Set up environment variables (.env.example created - user needs to create .env file)

## 2. Database Setup (Prisma + PostgreSQL)

* [X] Set up PostgreSQL database (Neon database configured and connected)
* [X] Configure Prisma schema with models:
  - User (email, name, role, organizationId)
  - Organization (name, settings, subscription)
  - Customer (name, email, phone, billingAddress, shippingAddress, paymentTerms, creditLimit)
  - Vendor (name, email, phone, address, paymentTerms)
  - Product (name, description, SKU, price, cost, type: product/service, category)
  - Invoice (number, date, dueDate, status, customer, subtotal, tax, total, organization)
  - InvoiceItem (invoice, product, quantity, rate, amount, description)
  - Payment (invoice, amount, date, method, reference, status)
  - Expense (date, amount, vendor, category, description, receipt, status)
  - Estimate (number, date, expiryDate, customer, items, status, convertedToInvoice)
  - LedgerAccount (code, name, type, parentId, organization)
  - LedgerEntry (date, account, debit, credit, description, reference, referenceId)
  - BankAccount (name, type, accountNumber, balance, organization)
  - BankTransaction (date, amount, description, type, bankAccount, matched, reconciled)
  - Subscription (organization, stripeSubscriptionId, status, plan, currentPeriodEnd)
  - Settings (organization, taxSettings, invoiceSettings, emailSettings)
* [X] Run Prisma migrations (Database schema pushed to Neon)
* [X] Seed initial data:
  - Default chart of accounts
  - Sample organization
  - Admin user

## 3. Authentication (next-auth@beta)

* [X] Configure NextAuth.js:
  - Email/Password authentication
  - OAuth providers (Google, GitHub)
  - Magic link authentication
  - JWT handling
  - Session management
* [X] Create auth pages:
  - Sign up page
  - Sign in page
  - Forgot password
  - Reset password
  - Magic link verification
* [X] Implement protected routes middleware
* [X] Create role-based access control (RBAC):
  - Admin (full access)
  - Accountant (financial operations)
  - Viewer (read-only)
* [X] Add user profile page
* [ ] Organization switching (if user belongs to multiple orgs)

## 4. Dashboard & Navigation

* [X] Main dashboard layout:
  - Sidebar navigation
  - Top header with user menu
  - Breadcrumbs
* [X] Dashboard overview page:
  - Key metrics cards (Revenue, Expenses, Profit, Cash Flow)
  - Charts (Recharts):
    - Revenue over time
    - Expenses breakdown
    - Profit trends
  - Recent transactions
  - Upcoming invoices
  - Low balance alerts
* [X] Responsive mobile navigation

## 5. Customer Management Module

* [X] Customers list page:
  - Table with pagination
  - Search and filters
  - Sort options
* [X] Create customer form:
  - Basic info (name, email, phone)
  - Billing address
  - Shipping address
  - Payment terms (Net 15, Net 30, etc.)
  - Credit limit
  - Tax information
* [X] Edit customer page
* [X] Customer detail page:
  - Overview
  - Invoice history
  - Payment history
  - Outstanding balance
  - Contact information
* [X] Delete customer (with validation)
* [ ] Customer import (CSV)

## 6. Vendor Management Module

* [X] Vendors list page:
  - Table with pagination
  - Search and filters
* [X] Create vendor form:
  - Basic info (name, email, phone)
  - Address
  - Payment terms
  - Tax information
* [X] Edit vendor page
* [X] Vendor detail page:
  - Overview
  - Expense history
  - Payment history
  - Outstanding balance
* [X] Delete vendor (with validation)

## 7. Products & Services Module

* [X] Products list page:
  - Table with filters
  - Product/Service toggle
  - Category filter
* [X] Create product form:
  - Name, description, SKU
  - Type (Product/Service)
  - Price and cost
  - Category
  - Inventory tracking (optional)
  - Tax settings
* [X] Edit product page
* [X] Product detail page
* [X] Delete product (with validation)
* [ ] Bulk import products (CSV)

## 8. Invoicing Module

* [X] Invoices list page:
  - Status filters (Draft, Sent, Paid, Overdue)
  - Date range filter
  - Customer filter
  - Search
* [X] Create invoice page:
  - Customer selection
  - Invoice number (auto-generated)
  - Date and due date
  - Line items (products/services):
    - Add/remove items
    - Quantity, rate, amount
    - Tax calculation
  - Subtotal, tax, total
  - Notes/terms
  - Save as draft or send
* [X] Edit invoice page
* [X] Invoice detail page:
  - Invoice preview
  - Status management
  - Payment tracking
  - Send email button (Resend)
  - Download PDF
  - Mark as paid
  - Record payment
* [ ] Invoice email template (Resend)
* [ ] PDF invoice generation
* [X] Invoice numbering system
* [ ] Recurring invoices (optional)

## 9. Estimates/Quotes Module

* [X] Estimates list page
* [X] Create estimate form (similar to invoice)
* [X] Estimate detail page
* [X] Convert estimate to invoice
* [ ] Send estimate email
* [ ] PDF estimate generation

## 10. Payments Module

* [X] Payments list page
* [X] Record payment form:
  - Invoice selection (implemented in invoice detail page)
  - Payment amount
  - Payment date
  - Payment method
  - Reference number
* [X] Payment detail page
* [X] Partial payments support (implemented in invoice payment tracking)
* [ ] Payment reconciliation

## 11. Expenses Module

* [X] Expenses list page:
  - Date range filter
  - Vendor filter
  - Category filter
  - Status filter
* [X] Create expense form:
  - Date
  - Vendor selection
  - Category
  - Amount
  - Description
  - Receipt upload (Uploadthing - URL field ready)
  - Payment method
  - Tax information
* [X] Edit expense page
* [X] Expense detail page:
  - Receipt viewer
  - Download receipt
* [X] Expense categories management (dynamic categories from existing expenses)
* [ ] Bulk expense import (CSV)

## 12. Chart of Accounts Module

* [X] Chart of accounts tree view:
  - Hierarchical display
  - Account types (Asset, Liability, Equity, Revenue, Expense)
  - Account codes
* [X] Create account form:
  - Account code
  - Account name
  - Account type
  - Parent account (for sub-accounts)
* [X] Edit account page
* [X] Account detail page:
  - Balance
  - Transaction history
* [X] Default chart of accounts setup (implemented in seed file)
* [X] Account balance calculations

## 13. General Ledger Module

* [X] General ledger view:
  - Date range filter
  - Account filter
  - Search
* [X] Ledger entries list:
  - Date, account, description
  - Debit/Credit columns
  - Balance
  - Reference
* [X] Manual journal entry form:
  - Date
  - Description
  - Debit entries
  - Credit entries
  - Validation (debits = credits)
* [ ] Auto ledger entries:
  - Invoice creation â†’ AR, Revenue
  - Payment received â†’ Cash, AR
  - Expense â†’ Expense, Cash/AP
  - Payment to vendor â†’ AP, Cash
* [X] Ledger entry detail page
* [X] Edit/Delete journal entries (with restrictions - only manual entries can be deleted)

## 14. Banking Module

* [X] Bank accounts list:
  - Account name, type, balance
* [X] Create bank account form
* [X] Bank transactions list:
  - Date range filter
  - Account filter
  - Match status filter
* [ ] Import bank statements (CSV):
  - File upload
  - Parse CSV
  - Map columns
  - Preview import
  - Import transactions
* [X] Transaction matching:
  - Manual matching (API ready for payment/expense matching)
  - Create new transaction
* [ ] Bank reconciliation:
  - Select statement period
  - Match transactions
  - Reconcile balance
* [X] Transaction detail page
* [X] Bank account detail page

## 15. Reports Module

* [ ] Reports dashboard
* [ ] Profit & Loss (P&L) Report:
  - Date range selection
  - Revenue breakdown
  - Expense breakdown
  - Net profit/loss
  - Charts (Recharts)
  - Export to PDF/CSV
* [ ] Balance Sheet Report:
  - Assets, Liabilities, Equity
  - Date selection
  - Export options
* [ ] Cash Flow Statement:
  - Operating activities
  - Investing activities
  - Financing activities
  - Charts
* [ ] General Ledger Report:
  - Account selection
  - Date range
  - Detailed entries
* [ ] Sales by Customer Report
* [ ] Sales by Product Report
* [ ] Expense Report:
  - By category
  - By vendor
  - Date range
* [ ] Tax Summary Report
* [ ] Aging Reports:
  - Accounts Receivable Aging
  - Accounts Payable Aging
* [ ] Custom date ranges
* [ ] Report scheduling (optional)

## 16. Subscription & Billing (Stripe)

* [ ] Subscription plans setup:
  - Free plan
  - Pro plan
  - Enterprise plan
* [ ] Stripe checkout integration:
  - Plan selection page
  - Checkout session
  - Success page
* [ ] Stripe webhooks:
  - Subscription created
  - Subscription updated
  - Subscription cancelled
  - Payment succeeded/failed
* [ ] Billing portal:
  - View invoices
  - Update payment method
  - Cancel subscription
  - Resume subscription
* [ ] Subscription status sync
* [ ] Usage limits enforcement
* [ ] Trial period handling

## 17. Settings Module

* [ ] Organization settings:
  - Business name, logo
  - Contact information
  - Address
  - Tax ID
* [ ] Invoice settings:
  - Invoice numbering format
  - Default payment terms
  - Invoice template
  - Email template customization
* [ ] Tax settings:
  - Tax rates
  - Tax categories
  - Default tax settings
* [ ] Email settings (Resend):
  - SMTP configuration
  - Email templates
  - From address
* [ ] User management:
  - Invite users
  - Manage roles
  - Remove users
* [ ] Chart of accounts settings
* [ ] Fiscal year settings
* [ ] Backup & export data

## 18. Additional Features

### 18.1 Email Notifications (Resend)
* [ ] Invoice sent email
* [ ] Payment received email
* [ ] Invoice overdue reminder
* [ ] Estimate sent email
* [ ] User invitation email
* [ ] Password reset email

### 18.2 File Uploads (Uploadthing)
* [ ] Receipt upload for expenses
* [ ] Document attachments
* [ ] Logo upload for organization
* [ ] Invoice attachments

### 18.3 Search & Filters
* [ ] Global search (invoices, customers, vendors, etc.)
* [ ] Advanced filters
* [ ] Saved filter presets

### 18.4 Data Export
* [ ] Export reports to PDF
* [ ] Export data to CSV/Excel
* [ ] Bulk export transactions

### 18.5 Performance & SEO
* [ ] Image optimization
* [ ] Loading states
* [ ] Error boundaries
* [ ] Skeleton loaders
* [ ] Pagination optimization

## 19. Testing & Deployment

* [ ] Unit tests for utilities and helpers
* [ ] Integration tests for API routes
* [ ] E2E tests for critical flows:
  - Invoice creation
  - Payment recording
  - Report generation
* [ ] Performance optimization
* [ ] Security audit
* [ ] Deploy to production
* [ ] Set up monitoring and error tracking
* [ ] Database backup strategy

---

# 6. Lessons

Record mistakes and avoid repeating them.
Example:

* Always validate payloads with Zod.
* Do not modify ledger logic without checking dependencies.
* Check Prisma changes before migrating.

---
